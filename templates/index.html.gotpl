<!DOCTYPE html>
<html lang="en">
<head>
    <title>Purser vulnerability report</title>
    <style>
        body {
          font-family: system-ui, sans-serif;
          font-weight: normal;
          padding: 2em;
        }

        h2 {
          margin-top: 2em;
          padding: 0.5em;
          border-radius: 5px;

          &.sev-CRITICAL {
            background-color: darkred;
            color: white;
          }

          &.sev-HIGH {
            background-color: darkorange;
            color: white;
          }

          &.sev-MEDIUM {
            background-color: yellow;
          }

          &.sev-LOW {
            background-color: green;
          }
        }

        ul {
          font-size: small;
          color: dimgray;
          list-style: none;

          &, li {
            display: inline-block;
            margin: 0;
            padding: 0 0.5ex 0 0;
          }
        }

        h3 {
          margin-bottom: 0;
          padding-bottom: 0;
        }

        h3:not(h2 + h3) {
          border-top: 1px solid lightgray;
          margin-top: 1em;
          padding-top: 1em;
        }
    </style>
</head>
<body>
<h1>Purser vulnerability report</h1>
{{range .Severities}}
    {{if .Vulnerabilities}}
        <h2 class="sev-{{.Name}}">{{.Name}}</h2>
        {{range .Vulnerabilities}}
            <h3 id="{{.Fingerprint}}">{{if .ID}}{{.ID}}:{{end}} {{.Title}}</h3>
            <ul>
                <li>Images:
                    <ul>
                        {{range .Images}}<li>{{.}}</li>{{end}}
                    </ul>
                </li>
                <li>Containers:
                    <ul>
                        {{range .Containers}}<li>{{.Name}}</li>{{end}}
                    </ul>
                </li>
                <li>Packages:
                    <ul>
                        {{range .Packages}}<li>{{.Name}} (detected: {{.InstalledVersion}}, fixed in; {{.FixedVersion}})</li>{{end}}
                    </ul>
                </li>
            </ul>
            <p>{{.Description}}</p>
        {{end}}
    {{end}}
{{end}}
</body>
</html>